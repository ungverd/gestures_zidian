import matplotlib.pyplot as plt
import numpy as np
from quaternion import quaternion
import os
from math import sqrt

a_x_theo = [-1.1379786002407855e-15, -0.17748125076739585, -0.3549759399537368, -0.5324974537803433, -0.7100591142660402, -0.8876741712330349, -1.0653557943057286, -1.2431170649048333, -1.4209709682393314, -1.5989303852986625, -1.7770080848476768, -1.9552167154268476, -2.133568797360229, -2.3120767147736974, -2.4907527076260223, -2.6696088637552835, -2.8486571109432326, -3.0279092090001063, -3.2073767418725128, -3.3870711097769934, -3.5670035213617375, -3.747184985899212, -3.927626305512156, -4.1083380674356516, -4.289330636317814, -4.4706141465617755, -4.652198494711531, -4.834093331884292, -5.016308056252004, -5.198851805574542, -5.38173344978736, -5.564961583646079, -5.748544519430736, -5.932490279712248, -6.116806590183744, -6.301500872559352, -6.486580237543089, -6.672051477870381, -6.85792106142495, -7.044195124433433, -7.230879464740628, -7.417979535167593, -7.605500436955435, -7.7934469132972275, -7.981823342960599, -8.170633734003577, -8.359881717586099, -8.549570541879902, -8.73970306607903, -8.930281754513594, -9.12130867086928, -9.31278547251489, -9.504713404940496, -9.69709329630853, -9.889925552120229, -10.083210149999779, -10.276946634598616, -10.471134112621982, -10.665771247980246, -10.860856257067233, -11.056386904167663, -11.252360496996232, -11.448773882370077, -11.645623442017303, -11.842905088523349, -12.040614261417435, -12.238745923401218, -12.437294556721604, -12.636254159689805, -12.835618243348595, -13.035379828289724, -13.235531441623365, -13.436065114101538, -13.63697237739731, -13.838244261541465, -14.039871292518626, -14.241843490024376, -14.44415036538495, -14.646780919641547, -14.849723641800239, -15.052966507249565, -15.256496976346963, -15.460301993175694, -15.66436798447332, -15.868680858733647, -16.073226005482773, -16.277988294730946, -16.4829520766013, -16.688101181136425, -16.893418918284127, -17.09888807806322, -17.304490930910276, -17.510209228208446, -17.716024202998994, -17.92191657087637, -18.127866531067603, -18.333853767696752, -18.539857451234695, -18.745856240135147, -18.951828282657203, -19.157751218874786, -19.363602182873436, -19.56935780513453, -19.77499421510739, -19.980487043969184, -20.185811427572645, -20.390942009581956, -20.595852944796164, -20.800517902660474, -21.00491007096487, -21.2090021597298, -21.412766405278738, -21.616174574496924, -21.819197969275876, -22.021807431143017, -22.223973346075823, -22.42566564949955, -22.626853831467912, -22.8275069420256, -23.027593596751885, -23.22708198248379, -23.42593986321838, -23.624134586192163, -23.82163308813687, -24.01840190170992, -24.21440716209832, -24.409614613794147, -24.603989617540464, -24.797497157445328, -24.99010184826286, -25.181767942838874, -25.37245933971944, -25.562139590920516, -25.750771909856113, -25.938319179423296, -26.124743960241602, -26.310008499044443, -26.494074737220423, -26.676904319501794, -26.85845860279771, -27.038698665169726, -27.217585314946867, -27.39507909997726, -27.571140317014027, -27.74572902123213, -27.91880503587374, -28.090327962018407, -28.260257188475897, -28.428551901797867, -28.5951710964055, -28.76007358483013, -28.923218008062925, -29.08456284601113, -29.244066428056954, -29.401686943715745, -29.55738245339014, -29.711110899216784, -29.862830116001746, -30.012497842241274, -30.160071731224285, -30.305509362212874, -30.448768251697004, -30.58980586472014, -30.728579626271532, -30.86504693274172, -30.999165163437354, -31.130891692151636, -31.260183898786458, -31.386999181022396, -31.511294966032878, -31.633028722238542, -31.75215797109786, -31.86864029893045, -31.982433368768987, -32.09349493223588, -32.201782841441116, -32.307255060897, -32.40986967944648, -32.509584922200965, -32.60635916248385, -32.70015093377611, -32.79091894166019, -32.878622075758436, -32.963219421662416, -33.0446702728497, -33.12293414258408, -33.19797077579589, -33.269740160939186, -33.338202541821694, -33.403318429404685, -33.465048613569046, -33.52335417484421, -33.57819649609701, -33.62953727417684, -33.67733853151414, -33.7215626276691, -33.76217227082766, -33.79913052924151, -33.83240084260949, -33.86194703339753, -33.88773331809408, -33.90972431839879, -33.92788507234127, -33.94218104532786, -33.95257814111375, -33.95904271269788, -33.96154157313853, -33.96004200628734, -33.95451177743932, -33.94491914389714, -33.931232865447306, -33.91342221474655, -33.89145698761644, -33.86530751324439, -33.834944664289516, -33.80033986689133, -33.761465110580346, -33.71829295808821, -33.67079655505683, -33.6189496396445, -33.56272655202801, -33.50210224379943, -33.43705228725645, -33.367552884585116, -33.293580876934016, -33.215113753378745, -33.13212965977573, -33.04460740750493, -32.9525264820998, -32.85586705176448, -32.75460997577695, -32.64873681277754, -32.53822982894225, -32.423072006039945, -32.30324704937304, -32.17873939560081, -32.04953422044471, -31.915617446275533, -31.776975749580927, -31.633596568313667, -31.485468109119182, -31.3325793544424, -31.17492006951285, -31.012480809207442, -30.845252924790273, -30.673228570528977, -30.49640071018619, -30.314763123386246, -30.128310411855455, -29.937038005535516, -29.74094216856897, -29.54002000515576, -29.334269465279622, -29.123689350303376, -28.9082793184319, -28.688039890041043, -28.462972452871735, -28.23307926708728, -27.99836347019243, -27.758829081812813, -27.51448100833216, -27.265325047386554, -27.01136789221259, -26.752617135848205, -26.489081275183302, -26.22076971485825, -25.947692771007613, -25.669861674846373, -25.38728857609639, -25.099986546249575, -24.807969581665496, -24.511252606499838, -24.209851475460574, -23.903782976388868, -23.593064832660637, -23.277715705405523, -22.957755195539647, -22.633203845608044, -22.30408314143275, -21.97041551356287, -21.63222433852191, -21.28953393984859, -20.942369588926134, -20.590757505596052, -20.234724858551473, -19.874299765505434, -19.50951129312957, -19.14038945675759, -18.766965219849745, -18.389270493212187, -18.00733813396693, -17.621201944267057, -17.230896669751758, -16.836457997736673, -16.437922555133767, -16.035327906095795, -15.628712549380474, -15.218115915428388, -14.803578363150493, -14.385141176419276, -13.96284656025903, -13.536737636730232, -13.10685844050247, -12.673253914112237, -12.235969902899608, -11.795053149620413, -11.350551288728159, -10.902512840322473, -10.450987203759336, -9.996024650918883, -9.537676319127696, -9.075994203730913, -8.611031150311728, -8.142840846554488, -7.671477813748417, -7.196997397929795, -6.719455760659227, -6.238909869432852, -5.755417487724975, -5.269037164660554, -4.779828224316876, -4.287850754652595, -3.793165596064421, -3.2958343295708605, -2.795919264622932, -2.29348342654301, -1.7885905435918792, -1.2813050336661096, -0.7716919906270125, -0.2598171702633092, 0.2542530241097338, 0.7704515564119991, 1.288710772917305, 1.8089624177256234, 2.3311376485845394, 2.8551670530549647, 3.3809806650160974, 3.9085079815038224, 4.437677979876363, 4.9684191353012, 5.500659438555197, 6.034326414131532, 6.569347138644531, 7.105648259524787, 7.643156013995254, 8.181796248318996, 8.72149443730927, 9.26217570409123, 9.803764840105044, 10.3461863253394, 10.889364348783545, 11.433222829086716, 11.977685435411953, 12.522675608472666, 13.06811658173799, 13.613931402794199, 14.160042954848738, 14.706373978362038, 15.252847092794065, 15.799384818449878, 16.345909598409996, 16.892343820530638, 17.438609839497683, 17.98462999892012, 18.530326653445886, 19.075622190885, 19.62043905432403, 20.16469976421489, 20.70832694042279, 21.2512433242158, 21.793371800180573, 22.33463541804701, 22.874957414405504, 23.41426123430093, 23.952470552685547, 24.489509295715823, 25.02530166187569, 25.559772142910692, 26.092845544556596, 26.62444700704634, 27.154502025379923, 27.682936469341108, 28.209676603245907, 28.734649105407623, 29.257781087303144, 29.779000112426672, 30.29823421481561, 30.815411917235387, 31.33046224900931, 31.84331476347996, 32.353899555089654, 32.86214727606732, 33.36798915270955, 33.87135700124472, 34.372183243268466, 34.870400920740394, 35.36594371053156, 35.85874593851307, 36.34874259317699, 36.83586933878038, 37.320062528005295, 37.80125921412645, 38.27939716267995, 38.754414862627144, 39.22625153700719, 39.69484715307378, 40.160142431911225, 40.622078857526, 41.08059868541062, 41.535644950576724, 41.987161475056205, 42.43509287486781, 42.87938456644931, 43.31998277255467, 43.756834527616505, 44.189887682575545, 44.61909090917782, 45.04439370374285, 45.46574639040489, 45.88310012383128, 46.29640689142203, 46.70561951499486, 47.110691651961396, 47.51157779600039, 47.90823327723382, 48.30061426191384, 48.68867775162685, 49.072381582023894, 49.451684421085005, 49.82654576692717, 50.19692594516505, 50.56278610583463, 50.924088219890436, 51.28079507528672, 51.632870272654536, 51.98027822058605, 52.32298413053813, 52.660954011368325, 52.99415466351525, 53.32255367283718, 53.64611940412207, 53.964820994283, 54.27862834525287, 54.58751211659286, 54.891443717829276, 55.19039530053348, 55.484339750159734, 55.77325067765667, 56.05710241086708, 56.33586998573192, 56.609529137314084, 56.87805629065736, 57.14142855149678, 57.39962369683566, 57.652620165405864, 57.90039704802661, 58.1429340778778, 58.38021162070411, 58.61221066496529, 58.83891281194863, 59.060300265859155, 59.27635582390335, 59.48706286638161, 59.6924053468052, 59.89236778205245, 60.08693524257965, 60.27609334270109, 60.45982823095335, 60.63812658055793, 60.81097557999666, 60.97836292371354, 61.14027680295733, 61.29670589677736, 61.447639363186816, 61.593066830505364, 61.732978388894125, 61.86736458209522, 61.996216399387315, 62.11952526776918, 62.23728304438176, 62.349482009180306, 62.45611485786582, 62.55717469508693, 62.65265502792083, 62.742549759642785, 62.826853183792934, 62.90555997854849, 62.978665201409115, 63.04616428420298, 63.10805302842041, 63.1643276008812, 63.21498452974218, 63.26002070084982, 63.29943335444345, 63.333220082213145, 63.3613788247168, 63.383907869159344, 63.4008058475377, 63.41207173515344, 63.41770484949573, 63.41770484949573, 63.41207173515344, 63.4008058475377, 63.383907869159344, 63.3613788247168, 63.333220082213145, 63.299433354443465, 63.26002070084982, 63.21498452974218, 63.1643276008812, 63.10805302842041, 63.046164284202995, 62.978665201409115, 62.90555997854849, 62.826853183792956, 62.74254975964277, 62.65265502792084, 62.55717469508694, 62.45611485786583, 62.349482009180335, 62.23728304438176, 62.11952526776918, 61.996216399387315, 61.86736458209524, 61.732978388894125, 61.59306683050536, 61.44763936318682, 61.296705896777375, 61.140276802957345, 60.978362923713576, 60.81097557999667, 60.638126580557945, 60.45982823095335, 60.27609334270112, 60.08693524257967, 59.89236778205246, 59.69240534680522, 59.48706286638162, 59.27635582390338, 59.060300265859205, 58.83891281194863, 58.612210664965296, 58.38021162070412, 58.142934077877804, 57.90039704802663, 57.65262016540588, 57.399623696835675, 57.14142855149679, 56.8780562906574, 56.60952913731409, 56.33586998573193, 56.05710241086709, 55.77325067765667, 55.484339750159755, 55.190395300533474, 54.8914437178293, 54.58751211659287, 54.278628345252876, 53.96482099428303, 53.64611940412208, 53.32255367283719, 52.994154663515275, 52.66095401136835, 52.322984130538146, 51.98027822058604, 51.63287027265454, 51.28079507528673, 50.92408821989045, 50.562786105834675, 50.19692594516506, 49.826545766927175, 49.45168442108501, 49.072381582023894, 48.68867775162687, 48.30061426191382, 47.90823327723383, 47.5115777960004, 47.11069165196145, 46.7056195149949, 46.296406891422045, 45.88310012383128, 45.46574639040489, 45.044393703742884, 44.619090909177864, 44.18988768257554, 43.75683452761651, 43.31998277255468, 42.87938456644937, 42.43509287486787, 41.98716147505619, 41.535644950576724, 41.08059868541061, 40.62207885752605, 40.16014243191127, 39.69484715307378, 39.226251537007194, 38.75441486262718, 38.27939716268, 37.80125921412652, 37.32006252800529, 36.83586933878038, 36.348742593176986, 35.8587459385131, 35.365943710531596, 34.8704009207404, 34.37218324326849, 33.87135700124477, 33.36798915270962, 32.86214727606729, 32.35389955508965, 31.84331476347996, 31.33046224900933, 30.815411917235437, 30.298234214815608, 29.77900011242669, 29.25778108730319, 28.734649105407662, 28.209676603245974, 27.682936469341076, 27.15450202537992, 26.624447007046356, 26.09284554455662, 25.559772142910735, 25.025301661875687, 24.48950929571585, 23.952470552685586, 23.41426123430098, 22.874957414405575, 22.33463541804698, 21.793371800180598, 21.25124332421582, 20.708326940422808, 20.164699764214937, 19.620439054324027, 19.07562219088504, 18.53032665344593, 17.98462999892019, 17.438609839497712, 16.89234382053061, 16.34590959841002, 15.799384818449898, 15.252847092794115, 14.706373978362084, 14.160042954848729, 13.613931402794242, 13.068116581738035, 12.52267560847274, 11.977685435411974, 11.433222829086688, 10.889364348783559, 10.346186325339424, 9.80376484010509, 9.262175704091275, 8.721494437309296, 8.181796248319035, 7.643156013995299, 7.105648259524808, 6.569347138644554, 6.034326414131524, 5.500659438555219, 4.968419135301218, 4.437677979876406, 3.9085079815038695, 3.380980665016137, 2.855167053055009, 2.3311376485845363, 1.8089624177256425, 1.2887107729173475, 0.7704515564120238, 0.2542530241097549, -0.25981717026329365, -0.7716919906269664, -1.2813050336660439, -1.7885905435918388, -2.293483426543012, -2.795919264622934, -3.2958343295708277, -3.79316559606442, -4.287850754652575, -4.779828224316862, -5.269037164660528, -5.755417487724915, -6.238909869432838, -6.719455760659226, -7.196997397929797, -7.671477813748427, -8.142840846554446, -8.611031150311733, -9.0759942037309, -9.537676319127677, -9.996024650918871, -10.45098720375928, -10.902512840322451, -11.35055128872816, -11.795053149620424, -12.235969902899608, -12.6732539141122, -13.106858440502478, -13.53673763673021, -13.962846560259019, -14.385141176419225, -14.803578363150432, -15.218115915428413, -15.628712549380491, -16.0353279060958, -16.43792255513373, -16.836457997736638, -17.23089666975175, -17.62120194426705, -18.007338133966922, -18.389270493212138, -18.766965219849695, -19.140389456757624, -19.509511293129577, -19.874299765505448, -20.23472485855143, -20.590757505596017, -20.942369588926134, -21.289533939848578, -21.632224338521876, -21.970415513562816, -22.30408314143269, -22.63320384560805, -22.957755195539654, -23.277715705405498, -23.59306483266061, -23.903782976388857, -24.209851475460567, -24.511252606499802, -24.807969581665475, -25.099986546249518, -25.387288576096335, -25.66986167484639, -25.947692771007592, -26.22076971485825, -26.489081275183292, -26.752617135848205, -27.011367892212576, -27.265325047386533, -27.514481008332126, -27.758829081812767, -27.998363470192462, -28.233079267087255, -28.46297245287173, -28.688039890041043, -28.908279318431884, -29.12368935030338, -29.3342694652796, -29.54002000515573, -29.740942168568946, -29.93703800553552, -30.12831041185546, -30.31476312338625, -30.496400710186187, -30.67322857052895, -30.84525292479026, -31.01248080920742, -31.17492006951283, -31.332579354442384, -31.485468109119154, -31.633596568313656, -31.776975749580938, -31.91561744627555, -32.0495342204447, -32.178739395600786, -32.30324704937304, -32.42307200603993, -32.53822982894223, -32.64873681277753, -32.75460997577695, -32.855867051764484, -32.95252648209981, -33.04460740750492, -33.13212965977573, -33.21511375337874, -33.293580876934016, -33.36755288458511, -33.437052287256435, -33.50210224379943, -33.562726552028025, -33.618949639644526, -33.670796555056825, -33.7182929580882, -33.761465110580346, -33.800339866891335, -33.83494466428951, -33.8653075132444, -33.89145698761644, -33.91342221474656, -33.93123286544733, -33.944919143897145, -33.954511777439336, -33.96004200628735, -33.96154157313852, -33.95904271269789, -33.95257814111373, -33.94218104532786, -33.92788507234127, -33.909724318398816, -33.88773331809409, -33.86194703339753, -33.8324008426095, -33.79913052924151, -33.76217227082766, -33.72156262766913, -33.677338531514124, -33.629537274176855, -33.57819649609703, -33.52335417484421, -33.46504861356906, -33.40331842940469, -33.33820254182169, -33.26974016093917, -33.19797077579591, -33.122934142584086, -33.04467027284972, -32.96321942166243, -32.878622075758436, -32.790918941660195, -32.70015093377611, -32.60635916248384, -32.50958492220097, -32.4098696794465, -32.307255060897, -32.20178284144114, -32.0934949322359, -31.982433368768973, -31.86864029893045, -31.75215797109785, -31.63302872223855, -31.511294966032892, -31.38699918102241, -31.26018389878645, -31.130891692151657, -30.99916516343736, -30.86504693274172, -30.72857962627154, -30.58980586472014, -30.448768251697004, -30.30550936221288, -30.1600717312243, -30.012497842241267, -29.862830116001753, -29.711110899216784, -29.55738245339014, -29.401686943715745, -29.244066428056946, -29.084562846011146, -28.923218008062932, -28.76007358483013, -28.595171096405494, -28.428551901797867, -28.260257188475897, -28.090327962018407, -27.91880503587376, -27.74572902123211, -27.57114031701402, -27.395079099977274, -27.217585314946888, -27.03869866516974, -26.858458602797704, -26.67690431950178, -26.494074737220437, -26.310008499044486, -26.124743960241595, -25.93831917942329, -25.750771909856127, -25.56213959092053, -25.372459339719462, -25.181767942838874, -24.990101848262853, -24.79749715744535, -24.603989617540478, -24.40961461379416, -24.214407162098304, -24.01840190170992, -23.82163308813687, -23.624134586192163, -23.425939863218396, -23.227081982483774, -23.02759359675187, -22.82750694202562, -22.626853831467905, -22.42566564949957, -22.223973346075837, -22.02180743114301, -21.819197969275884, -21.616174574496938, -21.412766405278752, -21.2090021597298, -21.004910070964876, -20.800517902660488, -20.59585294479617, -20.390942009581984, -20.185811427572645, -19.98048704396919, -19.774994215107412, -19.56935780513456, -19.363602182873457, -19.157751218874793, -18.951828282657203, -18.745856240135147, -18.539857451234717, -18.333853767696766, -18.127866531067603, -17.92191657087637, -17.71602420299901, -17.51020922820846, -17.30449093091029, -17.09888807806321, -16.893418918284134, -16.688101181136446, -16.482952076601308, -16.277988294730985, -16.07322600548277, -15.86868085873365, -15.664367984473337, -15.460301993175712, -15.256496976346977, -15.052966507249558, -14.84972364180026, -14.646780919641554, -14.444150365384981, -14.241843490024376, -14.039871292518637, -13.838244261541462, -13.636972377397324, -13.436065114101542, -13.235531441623394, -13.035379828289734, -12.835618243348595, -12.636254159689823, -12.43729455672161, -12.238745923401215, -12.040614261417435, -11.842905088523366, -11.645623442017307, -11.448773882370105, -11.252360496996243, -11.056386904167656, -10.860856257067244, -10.66577124798025, -10.471134112622003, -10.276946634598609, -10.083210149999786, -9.889925552120218, -9.697093296308545, -9.504713404940496, -9.312785472514879, -9.121308670869286, -8.930281754513597, -8.739703066079045, -8.54957054187993, -8.35988171758611, -8.170633734003573, -7.98182334296061, -7.793446913297231, -7.605500436955456, -7.4179795351676034, -7.2308794647406245, -7.04419512443345, -6.85792106142496, -6.6720514778704025, -6.48658023754308, -6.301500872559368, -6.116806590183746, -5.932490279712264, -5.74854451943075, -5.564961583646076, -5.381733449787369, -5.198851805574552, -5.016308056252026, -4.834093331884311, -4.652198494711534, -4.470614146561772, -4.2893306363178265, -4.1083380674356675, -3.927626305512179, -3.7471849858992172, -3.5670035213617446, -3.387071109777011, -3.2073767418725296, -3.027909209000118, -2.8486571109432246, -2.6696088637552933, -2.4907527076260303, -2.312076714773715, -2.133568797360244, -1.9552167154268494, -1.7770080848476901, -1.5989303852986736, -1.420970968239339, -1.2431170649048213, -1.065355794305733, -0.8876741712330394, -0.7100591142660544, -0.5324974537803546, -0.354975939953735, -0.17748125076740368, -8.049496865344195e-15, ]
a_z_theo = [-9.799999999999999, -9.826823607143606, -9.853648991784368, -9.880478222849154, -9.907313686194055, -9.934158083589496, -9.961014431792165, -9.987886061702865, -10.014776617610977, -10.041690056524397, -10.068630647585241, -10.095602971570113, -10.122611920474737, -10.149662697181778, -10.17676081521108, -10.203912098551166, -10.231122681571017, -10.258399009010297, -10.285747836047126, -10.313176228441435, -10.340691562752482, -10.368301526628338, -10.396014119165713, -10.42383765133789, -10.45178074648851, -10.47985234088897, -10.50806168435691, -10.536418340933228, -10.564932189614826, -10.593613425140457, -10.622472558826445, -10.651520419449458, -10.680768154172878, -10.71022722951374, -10.739909432346387, -10.76982687093987, -10.799991976024723, -10.8304175018858, -10.861116527477213, -10.892102457555122, -10.923389023824214, -10.954990286094093, -10.986920633440562, -11.019194785367688, -11.051827792966122, -11.084835040062565, -11.118232244356122, -11.152035458536169, -11.186261071376983, -11.220925808803937, -11.256046734926016, -11.291641253029457, -11.32772710652697, -11.364322379857128, -11.401445499328347, -11.439115233901731, -11.477350695907095, -11.516171341686247, -11.5555969721577, -11.595647733296705, -11.636344116524722, -11.677706959002034, -11.71975744381729, -11.762517100067896, -11.80600780282477, -11.850251772975152, -11.895271576936976, -11.94109012623848, -11.987730676956367, -12.035216829006075, -12.0835725252775, -12.132822050609661, -12.18299003059748, -12.23410143022425, -12.286181552312858, -12.339256035789377, -12.39335085375202, -12.448492311338983, -12.504707043388418, -12.562022011883865, -12.620464503178528, -12.680062124991682, -12.740842803170692, -12.802834778212, -12.866066601534705, -12.930567131500004, -12.996365529170376, -13.06349125380186, -13.131974058063388, -13.201843982976722, -13.273131352571056, -13.345866768246118, -13.42008110283786, -13.495805494380798, -13.573071339561476, -13.651910286857145, -13.732354229354343, -13.814435297242044, -13.898185849973892, -13.983638468094739, -14.070825944726408, -14.15978127670784, -14.250537655385186, -14.343128457047346, -14.437587233002677, -14.533947699292893, -14.632243726040322, -14.73250932642473, -14.834778645286564, -14.939085947353183, -15.0454656050851, -15.153952086139826, -15.264579940450368, -15.377383786916521, -15.492398299706878, -15.609658194169722, -15.729198212351669, -15.851053108122588, -15.9752576319063, -16.10184651501622, -16.230854453595825, -16.362316092164086, -16.49626600676614, -16.632738687729947, -16.771768522030104, -16.9133897752599, -17.057636573213813, -17.204542883082055, -17.35414249425994, -17.506468998774753, -17.661555771333273, -17.819435948993622, -17.980142410465152, -18.14370775504102, -18.310164281167737, -18.479543964657132, -18.65187843654607, -18.827198960609838, -19.005536410535477, -19.18692124676183, -19.371383492993388, -19.558952712395403, -19.749657983478407, -19.943527875680232, -20.140590424654615, -20.34087310727536, -20.544402816365835, -20.751205835163802, -20.961307811532095, -21.174733731926068, -21.39150789512903, -21.611653885767655, -21.835194547619352, -22.06215195672418, -22.292547394314607, -22.526401319576152, -22.763733342253083, -23.004562195113404, -23.24890570628749, -23.496780771496002, -23.748203326182015, -24.00318831756357, -24.261749676622856, -24.523900290048548, -24.78965197214857, -25.05901543675033, -25.33200026910657, -25.6086148978248, -25.88886656683858, -26.17276130743991, -26.46030391039141, -26.751497898138176, -27.046345497138702, -27.344847610335343, -27.647003789784282, -27.95281220946611, -28.26226963829754, -28.575371413365744, -28.892111413406546, -29.212482032548237, -29.536474154342915, -29.864077126107333, -30.195278733595575, -30.530065176026167, -30.8684210414859, -31.210329282733554, -31.555771193426033, -31.9047263847901, -32.25717276276286, -32.61308650562403, -32.97244204214324, -33.33521203026591, -33.70136733636063, -34.07087701505161, -34.44370828965945, -34.8198265332736, -35.19919525047939, -35.58177605976338, -35.96752867661951, -36.35641089737926, -36.74837858378889, -37.14338564835594, -37.54138404048781, -37.942323733444866, -38.34615271212971, -38.75281696173491, -39.16226045727074, -39.57442515399393, -39.98925097875885, -40.40667582231166, -40.826635532547854, -41.24906390875299, -41.67389269684668, -42.10105158564837, -42.53046820418445, -42.96206812005448, -43.39577483887436, -43.831509804814274, -44.269192402247874, -44.70873995852884, -45.15006774791126, -45.59308899662789, -46.037714889142194, -46.483854575587046, -46.93141518040355, -47.38030181219336, -47.830417574795646, -48.28166357960019, -48.733938959107576, -49.18714088174552, -49.64116456795132, -50.09590330752804, -50.55124847828205, -51.00708956594907, -51.46331418541403, -51.919808103230224, -52.376455261441805, -52.83313780271298, -53.28973609676657, -53.746128768133204, -54.20219272521223, -54.65780319064386, -55.11283373299151, -55.567156299732424, -56.020641251553464, -56.47315739794809, -56.92457203410983, -57.374750979116136, -57.82355861539634, -58.270857929475156, -58.71651055398392, -59.160376810928945, -59.60231575620706, -60.04218522535637, -60.47984188052906, -60.91514125867413, -61.347937820913515, -61.77808500309766, -62.20543526752324, -62.62984015579529, -63.051150342816534, -63.46921569188274, -63.88388531086544, -64.29500760945945, -64.70243035747401, -65.10600074414361, -65.50556543843504, -65.90097065032546, -66.29206219302587, -66.67868554612313, -67.06068591961348, -67.43790831879835, -67.8101976100146, -68.17739858716777, -68.53935603903899, -68.89591481733294, -69.24691990543552, -69.59221648784755, -69.9316500202613, -70.26506630024565, -70.59231153850419, -70.91323243067129, -71.22767622961005, -71.53549081817455, -71.83652478239982, -72.13062748508132, -72.41764913970529, -72.697440884692, -72.96985485791117, -73.23474427143131, -73.49196348646176, -73.7413680884476, -73.9828149622761, -74.2161623675541, -74.44127001391438, -74.65799913630983, -74.86621257025307, -75.06577482696002, -75.25655216835457, -75.43841268189253, -75.611226355162, -75.77486515021799, -75.9292030776084, -76.07411627004892, -76.20948305570458, -76.33518403103474, -76.45110213315995, -76.5571227117076, -76.65313360009466, -76.73902518620551, -76.81469048242239, -76.88002519496781, -76.9349277925167, -76.97929957403782, -77.01304473582327, -77.03607043766556, -77.04828686814282, -77.0496073089712, -77.03994819838627, -77.01922919351391, -76.98737323169219, -76.94430659070629, -76.8899589478993, -76.82426343812128, -76.74715671048035, -76.65857898386017, -76.55847410116776, -76.44678958227776, -76.32347667563816, -76.1884904085044, -76.04178963576868, -75.88333708735259, -75.713099414131, -75.53104723235673, -75.33715516655548, -75.13140189086181, -74.91377016876704, -74.68424689125163, -74.44282311327424, -74.18949408859086, -73.92425930287921, -73.6471225051421, -73.35809173736652, -73.05717936241518, -72.74440209012694, -72.4197810016054, -72.0833415716743, -71.7351136894798, -71.37513167721981, -71.0034343069827, -70.62006481567775, -70.22507091803959, -69.81850481769247, -69.40042321625761, -68.97088732049086, -68.52996284743661, -68.07772002758588, -67.61423360602704, -67.13958284157854, -66.6538515038937, -66.15712786852929, -65.64950470996908, -65.13107929259651, -64.60195335960883, -64.06223311986855, -63.51202923268818, -62.951456790543084, -62.38063529971206, -61.79968865884241, -61.20874513543988, -60.60793734028292, -59.99740219976307, -59.37728092615326, -58.74771898580668, -58.108866065291195, -57.460876035462924, -56.80390691348586, -56.13812082280375, -55.46368395107193, -54.78076650605832, -54.089542669522174, -53.39019054908257, -52.6828921280866, -51.96783321349101, -51.24520338177025, -50.51519592286482, -49.77800778218658, -49.03383950069599, -48.28289515306937, -47.525382283974636, -46.76151184247406, -45.991498114574796, -45.21555865394873, -44.43391421084282, -43.646788659204354, -42.85440892204439, -42.05700489506492, -41.25480936857605, -40.44805794772968, -39.63698897109907, -38.82184342763142, -38.002864872005674, -37.180299338425236, -36.354395252877566, -35.52540334389501, -34.69357655184868, -33.859169936812464, -33.02244058503156, -32.1836475140328, -31.34305157641502, -30.50091536235702, -29.65750310088421, -28.813080559932896, -27.967914945255114, -27.122274798205588, -26.276429892453496, -25.43065112966472, -24.585210434197858, -23.740380646860864, -22.896435417774633, -22.053649098390466, -21.212296632710743, -20.372653447760566, -19.534995343360947, -18.699598381254045, -17.866738773630587, -17.03669277111326, -16.209736550246447, -15.38614610054735, -14.566197111171277, -13.750164857245714, -12.938324085928542, -12.130948902245029, -11.328312654760946, -10.530687821146682, -9.738345893690768, -8.951557264819568, -8.170591112680157, -7.395715286845951, -6.6271961942021615, -5.8652986850705275, -5.11028593963184, -4.362419354705386, -3.621958430945151, -2.8891606605111146, -2.1642814152762178, -1.4475738356281962, -0.7392887199251454, -0.03967441466565802, 0.6510232945680929, 1.332561291334649, 2.0046992356653774, 2.6671996704461014, 3.319828126788593, 3.9623532283346385, 4.594546794433272, 5.216183942134073, 5.827043186939399, 6.426906542257706, 7.0155596175026655, 7.592791714781237, 8.158395924115895, 8.712169217146352, 9.253912539256323, 9.783430900072872, 10.300533462284857, 10.80503362872916, 11.296749127694282, 11.775502096390113, 12.241119162536107, 12.69343152401856, 13.132275026570653, 13.55749023942871, 13.96892252891972, 14.366422129936534, 14.749844215257234, 15.11904896266805, 15.4739016198486, 15.814272566980762, 16.140037377043527, 16.451076873756865, 16.747277187139872, 17.028529806649203, 17.294731631865513, 17.54578502069716, 17.78159783507128, 18.002083484084906, 18.20716096458908, 18.396754899181417, 18.570795571583844, 18.72921895938338, 18.871966764116195, 18.998986438676162, 19.11023121203109, 19.20566011123138, 19.285237980697453, 19.348935498774065, 19.396729191541258, 19.42860144387341, 19.444540507739504, 19.444540507739504, 19.42860144387341, 19.39672919154126, 19.34893549877407, 19.28523798069746, 19.205660111231378, 19.11023121203109, 18.998986438676166, 18.871966764116202, 18.729218959383395, 18.570795571583844, 18.396754899181424, 18.207160964589086, 18.002083484084935, 17.781597835071317, 17.54578502069715, 17.294731631865524, 17.028529806649214, 16.7472771871399, 16.451076873756907, 16.140037377043534, 15.814272566980776, 15.473901619848618, 15.119048962668089, 14.749844215257252, 14.36642212993652, 13.968922528919741, 13.557490239428724, 13.132275026570706, 12.693431524018617, 12.241119162536123, 11.775502096390136, 11.296749127694296, 10.805033628729214, 10.300533462284891, 9.783430900072897, 9.253912539256335, 8.712169217146373, 8.158395924115961, 7.592791714781314, 7.015559617502694, 6.426906542257726, 5.827043186939421, 5.216183942134109, 4.594546794433316, 3.962353228334657, 3.31982812678862, 2.6671996704461263, 2.0046992356654556, 1.3325612913346676, 0.6510232945681178, -0.03967441466563315, -0.7392887199251206, -1.4475738356281447, -2.1642814152762444, -2.8891606605110844, -3.6219584309451243, -4.362419354705356, -5.11028593963176, -5.865298685070524, -6.62719619420213, -7.395715286845926, -8.170591112680118, -8.951557264819531, -9.738345893690804, -10.530687821146644, -11.328312654760923, -12.130948902244988, -12.93832408592845, -13.750164857245698, -14.566197111171244, -15.386146100547311, -16.209736550246404, -17.03669277111321, -17.866738773630615, -18.69959838125401, -19.534995343360904, -20.372653447760474, -21.212296632710647, -22.05364909839043, -22.89643541777462, -23.74038064686086, -24.585210434197798, -25.43065112966464, -26.276429892453503, -27.122274798205552, -27.9679149452551, -28.8130805599328, -29.657503100884107, -30.500915362357066, -31.34305157641503, -32.1836475140328, -33.02244058503148, -33.8591699368124, -34.693576551848665, -35.52540334389497, -36.35439525287754, -37.18029933842512, -38.00286487200557, -38.821843427631414, -39.636988971099065, -40.44805794772968, -41.25480936857596, -42.05700489506486, -42.854408922044364, -43.64678865920432, -44.43391421084277, -45.215558653948634, -45.99149811457483, -46.761511842474064, -47.52538228397462, -48.28289515306933, -49.033839500695926, -49.77800778218659, -50.515195922864805, -51.245203381770196, -51.96783321349097, -52.6828921280865, -53.39019054908259, -54.08954266952219, -54.78076650605828, -55.46368395107191, -56.1381208228037, -56.80390691348586, -57.46087603546291, -58.10886606529116, -58.74771898580664, -59.377280926153176, -59.997402199763094, -60.60793734028291, -61.20874513543986, -61.7996886588424, -62.38063529971201, -62.95145679054311, -63.51202923268814, -64.06223311986854, -64.60195335960873, -65.13107929259648, -65.64950470996912, -66.15712786852926, -66.65385150389366, -67.13958284157853, -67.61423360602701, -68.07772002758587, -68.5299628474366, -68.97088732049083, -69.40042321625755, -69.81850481769246, -70.2250709180396, -70.62006481567771, -71.00343430698271, -71.37513167721977, -71.73511368947976, -72.08334157167434, -72.41978100160536, -72.7444020901269, -73.05717936241521, -73.35809173736652, -73.64712250514206, -73.92425930287922, -74.18949408859088, -74.44282311327419, -74.68424689125165, -74.91377016876702, -75.13140189086178, -75.3371551665555, -75.53104723235674, -75.71309941413097, -75.8833370873526, -76.04178963576867, -76.18849040850439, -76.3234766756382, -76.44678958227773, -76.55847410116775, -76.65857898386017, -76.74715671048038, -76.82426343812126, -76.88995894789933, -76.94430659070628, -76.98737323169217, -77.01922919351397, -77.03994819838624, -77.04960730897118, -77.04828686814284, -77.03607043766559, -77.01304473582324, -76.97929957403784, -76.93492779251669, -76.8800251949678, -76.81469048242242, -76.73902518620552, -76.65313360009468, -76.55712271170759, -76.45110213315996, -76.33518403103471, -76.2094830557046, -76.07411627004895, -75.92920307760839, -75.77486515021803, -75.611226355162, -75.43841268189252, -75.25655216835459, -75.06577482696002, -74.86621257025304, -74.65799913630983, -74.44127001391438, -74.21616236755416, -73.98281496227614, -73.7413680884476, -73.49196348646177, -73.23474427143134, -72.9698548579112, -72.69744088469199, -72.41764913970529, -72.13062748508129, -71.83652478239985, -71.5354908181746, -71.22767622961004, -70.91323243067133, -70.59231153850422, -70.26506630024572, -69.93165002026136, -69.59221648784752, -69.2469199054355, -68.89591481733297, -68.53935603903902, -68.17739858716777, -67.81019761001458, -67.4379083187984, -67.0606859196135, -66.67868554612322, -66.29206219302593, -65.90097065032546, -65.50556543843507, -65.10600074414364, -64.70243035747403, -64.29500760945943, -63.883885310865445, -63.46921569188278, -63.0511503428166, -62.62984015579533, -62.205435267523214, -61.7780850030977, -61.34793782091354, -60.91514125867413, -60.4798418805291, -60.042185225356356, -59.602315756207105, -59.160376810929, -58.716510553983966, -58.27085792947516, -57.82355861539633, -57.37475097911614, -56.92457203410982, -56.473157397948135, -56.02064125155351, -55.56715629973244, -55.112833732991554, -54.657803190643904, -54.2021927252123, -53.74612876813323, -53.28973609676654, -52.83313780271297, -52.37645526144182, -51.919808103230245, -51.46331418541408, -51.00708956594911, -50.55124847828209, -50.095903307528076, -49.64116456795135, -49.187140881745535, -48.733938959107576, -48.28166357960022, -47.83041757479566, -47.38030181219339, -46.93141518040359, -46.483854575587046, -46.03771488914225, -45.59308899662789, -45.15006774791125, -44.70873995852887, -44.269192402247874, -43.831509804814296, -43.395774838874374, -42.96206812005452, -42.5304682041845, -42.101051585648385, -41.67389269684668, -41.249063908753, -40.826635532547854, -40.406675822311676, -39.98925097875885, -39.574425153993936, -39.16226045727078, -38.75281696173494, -38.34615271212975, -37.94232373344485, -37.541384040487806, -37.143385648355924, -36.74837858378892, -36.35641089737929, -35.96752867661951, -35.581776059763406, -35.19919525047943, -34.81982653327363, -34.443708289659476, -34.070877015051586, -33.701367336360626, -33.33521203026592, -32.97244204214325, -32.61308650562402, -32.25717276276288, -31.90472638479012, -31.555771193426054, -31.210329282733596, -30.86842104148587, -30.53006517602615, -30.195278733595575, -29.864077126107347, -29.536474154342947, -29.21248203254824, -28.892111413406546, -28.575371413365765, -28.262269638297564, -27.95281220946615, -27.64700378978427, -27.344847610335346, -27.046345497138716, -26.751497898138183, -26.46030391039143, -26.172761307439906, -25.8888665668386, -25.608614897824822, -25.3320002691066, -25.059015436750364, -24.78965197214856, -24.523900290048545, -24.261749676622856, -24.00318831756358, -23.748203326182036, -23.496780771496017, -23.24890570628751, -23.004562195113422, -22.76373334225311, -22.526401319576188, -22.292547394314603, -22.062151956724186, -21.835194547619352, -21.611653885767673, -21.39150789512908, -21.174733731926047, -20.961307811532112, -20.751205835163802, -20.54440281636586, -20.340873107275364, -20.140590424654604, -19.943527875680257, -19.749657983478418, -19.558952712395445, -19.371383492993402, -19.186921246761845, -19.005536410535463, -18.827198960609863, -18.651878436546067, -18.479543964657125, -18.310164281167754, -18.14370775504103, -17.98014241046519, -17.81943594899363, -17.661555771333276, -17.506468998774736, -17.354142494259957, -17.20454288308206, -17.057636573213838, -16.91338977525992, -16.7717685220301, -16.632738687729972, -16.49626600676614, -16.362316092164072, -16.23085445359581, -16.101846515016234, -15.975257631906302, -15.8510531081226, -15.729198212351664, -15.609658194169723, -15.492398299706894, -15.377383786916528, -15.264579940450353, -15.153952086139839, -15.045465605085111, -14.939085947353178, -14.83477864528658, -14.732509326424722, -14.632243726040342, -14.53394769929291, -14.43758723300268, -14.343128457047335, -14.250537655385198, -14.159781276707838, -14.070825944726403, -13.98363846809475, -13.898185849973892, -13.814435297242056, -13.732354229354353, -13.651910286857138, -13.573071339561467, -13.495805494380798, -13.420081102837855, -13.345866768246129, -13.273131352571058, -13.201843982976715, -13.1319740580634, -13.063491253801867, -12.99636552917039, -12.9305671315, -12.866066601534698, -12.802834778211993, -12.740842803170697, -12.680062124991682, -12.620464503178521, -12.562022011883876, -12.504707043388416, -12.448492311338988, -12.393350853752022, -12.339256035789377, -12.286181552312856, -12.234101430224253, -12.182990030597484, -12.132822050609676, -12.083572525277518, -12.035216829006075, -11.987730676956367, -11.94109012623848, -11.89527157693698, -11.850251772975144, -11.806007802824785, -11.762517100067898, -11.719757443817292, -11.677706959002034, -11.636344116524725, -11.595647733296694, -11.55559697215769, -11.516171341686256, -11.477350695907086, -11.439115233901736, -11.401445499328345, -11.364322379857136, -11.327727106526973, -11.291641253029459, -11.256046734926024, -11.220925808803933, -11.186261071376986, -11.15203545853617, -11.118232244356122, -11.08483504006257, -11.05182779296613, -11.01919478536769, -10.986920633440564, -10.954990286094096, -10.923389023824214, -10.892102457555115, -10.861116527477225, -10.830417501885798, -10.799991976024694, -10.76982687093987, -10.739909432346382, -10.710227229513745, -10.680768154172885, -10.651520419449456, -10.622472558826441, -10.593613425140454, -10.564932189614833, -10.536418340933235, -10.50806168435691, -10.479852340888964, -10.451780746488513, -10.423837651337877, -10.396014119165715, -10.368301526628334, -10.340691562752475, -10.313176228441433, -10.285747836047115, -10.2583990090103, -10.231122681571021, -10.203912098551179, -10.176760815211077, -10.1496626971818, -10.122611920474746, -10.095602971570116, -10.068630647585248, -10.041690056524397, -10.01477661761097, -9.98788606170286, -9.961014431792165, -9.934158083589496, -9.907313686194058, -9.88047822284916, -9.853648991784368, -9.82682360714361, -9.8, ]
theta_t = [0.0, 4.995961114585029e-08, 3.996804461301544e-07, 1.3489415106743193e-06, 3.1975573604156115e-06, 6.24539584158057e-06, 1.0792395790461258e-05, 1.7138584677666285e-05, 2.5584096184121697e-05, 3.642918769434008e-05, 4.9974257693906625e-05, 6.651986305760778e-05, 8.636673621369277e-05, 0.00010981580217184558, 0.00013716819540059906, 0.00016872527654153348, 0.00020478864894548358, 0.00024566017501872757, 0.00029164199236542316, 0.00034303652971248033, 0.00040014652260442354, 0.0004632750288550778, 0.0005327254437433214, 0.0006088015149371021, 0.0006918073571393981, 0.0007820474664347003, 0.0008798267343316285, 0.0009854504614823362, 0.0010992243710715712, 0.0012214546218587943, 0.001352447820863645, 0.0014925110356818513, 0.0016419518064199386, 0.001801078157234669, 0.0019701986074695324, 0.002149622182371791, 0.002339658423382571, 0.0025406173979866274, 0.002752809709109101, 0.002976546504052123, 0.003212139482956864, 0.003459900906781013, 0.0037201436047808382, 0.003993180981489156, 0.004279327023175991, 0.004578896303782148, 0.004892203990320172, 0.005219565847723556, 0.005561298243145388, 0.005917718149687908, 0.006289143149559274, 0.006675891436644185, 0.007078281818484216, 0.007496633717652858, 0.007931267172523761, 0.008382502837416731, 0.008850661982119363, 0.009336066490769759, 0.009839038860099783, 0.010359902197026287, 0.010898980215582978, 0.01145659723318749, 0.012033078166237316, 0.012628748525025164, 0.0132439344079674, 0.013878962495143667, 0.014534160041132956, 0.015209854867152081, 0.01590637535247713, 0.016624050425154663, 0.01736320955198878, 0.01812418272780493, 0.01890730046398255, 0.01971289377624982, 0.02054129417174296, 0.02139283363532083, 0.0222678446151299, 0.023166660007421767, 0.024089613140613902, 0.02503703775859393, 0.026009268003264148, 0.027006638396321708, 0.028029483820274686, 0.029078139498692004, 0.030152940975681206, 0.03125422409459707, 0.032382324975979114, 0.033537579994713976, 0.034720325756424496, 0.03593089907308397, 0.03716963693785595, 0.0384368764991577, 0.03973295503394967, 0.04105820992025067, 0.04241297860887674, 0.04379759859441215, 0.045212407385404066, 0.04665774247378768, 0.0481339413035465, 0.0496413412386021, 0.05118027952993995, 0.05275109328197767, 0.054354119418169276, 0.055989694645856423, 0.0576581554203666, 0.0593598379083619, 0.06109507795044139, 0.06286421102300603, 0.06466757219938271, 0.06650549611021796, 0.06837831690314419, 0.07028636820172167, 0.07222998306366854, 0.07420949393837127, 0.07622523262369932, 0.07827753022211045, 0.08036671709607209, 0.08249312282278916, 0.08465707614825756, 0.08685890494063876, 0.08909893614297687, 0.09137749572525355, 0.09369490863579251, 0.09605149875202547, 0.0984475888306222, 0.10088350045699687, 0.10335955399419787, 0.10587606853119261, 0.10843336183054982, 0.11103175027554112, 0.11367154881665308, 0.11635307091754601, 0.11907662850043663, 0.12184253189094815, 0.12465108976241351, 0.12750260907965513, 0.1303973950422488, 0.13333575102728384, 0.1363179785316299, 0.13934437711372163, 0.14241524433487557, 0.1455308757001489, 0.14869156459875332, 0.15189760224403684, 0.15514927761304625, 0.1584468773856797, 0.16179068588344897, 0.1651809850078593, 0.16861805417842268, 0.17210217027031474, 0.17563360755169663, 0.17921263762070574, 0.1828395293421386, 0.18651454878383342, 0.1902379591527702, 0.19401002073090212, 0.19783099081073538, 0.20170112363066497, 0.20562067031009218, 0.2095898787843278, 0.21360899373930803, 0.21767825654612635, 0.22179790519540732, 0.2259681742315314, 0.2301892946867306, 0.23446149401506805, 0.23878499602631847, 0.24316002081976898, 0.24758678471794993, 0.25206550020031787, 0.2565963758369062, 0.2611796162219553, 0.2658154219075508, 0.2705039893372668, 0.27524551077985465, 0.28004017426297384, 0.2848881635069969, 0.2897896578588941, 0.2947448322262235, 0.2997538570112395, 0.30481689804513773, 0.30993411652245323, 0.3151056689356325, 0.3203317070097921, 0.32561237763768264, 0.33094782281488244, 0.3363381795752242, 0.3417835799264888, 0.3472841507863698, 0.3528400139187367, 0.35845128587020686, 0.3641180779070499, 0.36984049595243756, 0.37561864052405763, 0.3814526066721165, 0.3873424839177341, 0.3932883561917617, 0.3992903017740358, 0.40534839323308103, 0.41146269736629043, 0.41763327514058934, 0.4238601816336046, 0.43014346597536307, 0.436483171290524, 0.4428793346411766, 0.44933198697020493, 0.45584115304525524, 0.46240685140330684, 0.4690290942958718, 0.47570788763483973, 0.4824432309389867, 0.48923511728115354, 0.4960835332361327, 0.5029884588292534, 0.509949867485706, 0.5169677259806053, 0.5240419943898167, 0.5311726260415636, 0.5383595674688237, 0.5456027583625396, 0.5529021315256542, 0.5602576128279886, 0.5676691211619749, 0.5751365683992727, 0.5826598593482578, 0.5902388917124326, 0.5978735560497429, 0.6055637357328365, 0.6133093069102703, 0.6211101384686786, 0.6289660919959214, 0.6368770217452292, 0.6448427746003493, 0.6528631900417174, 0.6609381001136639, 0.6690673293926686, 0.6772506949566761, 0.6854880063554913, 0.6937790655822582, 0.7021236670460452, 0.7105215975455443, 0.7189726362438912, 0.7274765546446331, 0.7360331165688433, 0.7446420781333996, 0.7533031877304374, 0.7620161860079894, 0.7707808058518242, 0.7795967723684885, 0.7884638028695754, 0.7973816068572206, 0.8063498860108288, 0.8153683341750667, 0.8244366373491047, 0.8335544736771259, 0.8427215134401274, 0.8519374190489888, 0.8612018450388572, 0.8705144380648255, 0.8798748368989218, 0.8892826724284314, 0.8987375676555349, 0.9082391376982929, 0.9177869897929635, 0.9273807232976808, 0.9370199296974837, 0.9467041926107074, 0.9564330877967513, 0.9662061831652096, 0.9760230387863957, 0.9858832069032438, 0.9957862319446023, 1.0057316505399245, 1.0157189915353595, 1.0257477760112392, 1.0358175173009865, 1.0459277210114164, 1.0560778850444674, 1.066267499620338, 1.0764960473020482, 1.0867630030214204, 1.0970678341064803, 1.1074100003102922, 1.1177889538412065, 1.1282041393945466, 1.1386549941857178, 1.1491409479847392, 1.1596614231522189, 1.170215834676737, 1.1808035902136738, 1.1914240901254527, 1.2020767275232116, 1.2127608883098995, 1.2234759512247921, 1.2342212878894268, 1.2449962628549616, 1.2558002336509324, 1.266632550835443, 1.2774925580467404, 1.2883795920562109, 1.2992929828227702, 1.3102320535486427, 1.321196120736542, 1.3321844942482308, 1.343196477364463, 1.3542313668462966, 1.3652884529977851, 1.3763670197300202, 1.3874663446265325, 1.3985856990100511, 1.4097243480105912, 1.4208815506348842, 1.432056559837133, 1.4432486225910817, 1.4544569799634015, 1.46568086718837, 1.4769195137438509, 1.4881721434285473, 1.4994379744405346, 1.5107162194570531, 1.5220060857155566, 1.533306775095996, 1.5446174842043456, 1.555937404457334, 1.5672657221684017, 1.5786016186348382, 1.5899442702261186, 1.6012928484734024, 1.612646520160197, 1.6240044474141688, 1.6353657878000845, 1.646729694413881, 1.6580953159778318, 1.669461796936811, 1.6808282775556418, 1.692193894017499, 1.7035577785233655, 1.714919059392531, 1.7262768611640917, 1.7376303046994723, 1.748978507285925, 1.7603205827410024, 1.7716556415179894, 1.7829827908122724, 1.7943011346686248, 1.8056097740894075, 1.816907807143653, 1.8281943290770157, 1.839468432422589, 1.8507292071125372, 1.8619757405905621, 1.873207117925159, 1.8844224219236556, 1.8956207332470139, 1.9068011305253698, 1.9179626904742986, 1.9291044880117858, 1.9402255963758812, 1.9513250872430177, 1.962402030846973, 1.973455496098456, 1.9844845507053064, 1.9954882612932605, 2.0064656935273035, 2.0174159122335387, 2.0283379815216023, 2.0392309649075635, 2.0500939254373085, 2.0609259258103854, 2.0717260285042793, 2.0824932958991123, 2.093226790402724, 2.103925574576133, 2.114588711259346, 2.125215263697491, 2.1358042956672536, 2.146354871603607, 2.1568660567267863, 2.1673369171695143, 2.177766520104431, 2.188153933871725, 2.1984982281069256, 2.2087984738688453, 2.2190537437676507, 2.2292631120930224, 2.239425654942403, 2.249540450349289, 2.259606578411565, 2.2696231214198384, 2.279589163985754, 2.2895037931702813, 2.2993660986119324, 2.3091751726548884, 2.318930110477034, 2.3286300102178332, 2.3382739731060758, 2.347861103587425, 2.3573905094517693, 2.36686130196035, 2.37627259597263, 2.3856235100728957, 2.3949131666965595, 2.4041406922561466, 2.413305217266922, 2.422405876472174, 2.431441808968084, 2.440412158328197, 2.449316072727448, 2.458152705065734, 2.466921213090989, 2.47562075952177, 2.4842505121693024, 2.4928096440589687, 2.501297333551238, 2.5097127644619746, 2.518055126182149, 2.526323613796886, 2.5345174282038556, 2.5426357762309806, 2.5506778707534146, 2.558642930809811, 2.566530181717816, 2.574338855188799, 2.582068189441776, 2.589717429316516, 2.5972858263858005, 2.6047726390668293, 2.6121771327317282, 2.6194985798171637, 2.6267362599330184, 2.633889459970134, 2.640957474207065, 2.6479396044158667, 2.6548351599668556, 2.6616434579323514, 2.668363823189366, 2.674995588521223, 2.6815380947180882, 2.687990690676397, 2.694352733497151, 2.700623588583065, 2.70680262973456, 2.7128892392445616, 2.718882807992104, 2.724782735534711, 2.7305884301995427, 2.736299309173282, 2.7419147985907544, 2.7474343336222526, 2.752857358559562, 2.7581833269006513, 2.763411701433034, 2.7685419543157694, 2.7735735671600934, 2.778506031108655, 2.7833388469133666, 2.788071525011809, 2.7927035856022364, 2.797234558717101, 2.8016639842951423, 2.805991412251986, 2.8102164025492526, 2.814338525262174, 2.818357360645679, 2.8222724991989616, 2.8260835417284995, 2.829790099409523, 2.8333917938459154, 2.8368882571285345, 2.840279131891948, 2.8435640713695625, 2.846742739447152, 2.849814810714749, 2.8527799705169192, 2.855637915001381, 2.858388351165987, 2.861030996904033, 2.8635655810479035, 2.8659918434110367, 2.868309534828212, 2.8705184171941256, 2.872618263500282, 2.8746088578701667, 2.876489995592708, 2.878261483154012, 2.879923138267373, 2.8814747899015427, 2.882916278307274, 2.8842474550420976, 2.885468182993371, 2.8865783363995523, 2.887577800869734, 2.888466473401399, 2.88924426239642, 2.8899110876752823, 2.890466880489541, 2.8909115835324988, 2.891245150948111, 2.891467548338107, 2.891578752767339, 2.891578752767339, 2.891467548338107, 2.891245150948111, 2.890911583532499, 2.890466880489541, 2.8899110876752823, 2.8892442623964207, 2.888466473401399, 2.887577800869734, 2.886578336399553, 2.885468182993371, 2.8842474550420976, 2.882916278307274, 2.881474789901543, 2.879923138267373, 2.878261483154012, 2.876489995592708, 2.8746088578701667, 2.872618263500282, 2.870518417194126, 2.868309534828212, 2.865991843411037, 2.863565581047904, 2.861030996904033, 2.8583883511659876, 2.855637915001381, 2.8527799705169192, 2.84981481071475, 2.8467427394471523, 2.8435640713695634, 2.840279131891948, 2.8368882571285345, 2.833391793845916, 2.829790099409524, 2.8260835417284995, 2.822272499198962, 2.818357360645679, 2.814338525262174, 2.8102164025492526, 2.8059914122519864, 2.8016639842951427, 2.797234558717101, 2.7927035856022364, 2.7880715250118104, 2.7833388469133666, 2.7785060311086553, 2.773573567160093, 2.7685419543157694, 2.763411701433034, 2.7581833269006517, 2.7528573585595626, 2.7474343336222535, 2.7419147985907544, 2.736299309173283, 2.7305884301995427, 2.724782735534711, 2.718882807992104, 2.712889239244562, 2.706802629734561, 2.7006235885830656, 2.694352733497151, 2.6879906906763975, 2.6815380947180887, 2.674995588521224, 2.6683638231893663, 2.661643457932352, 2.654835159966856, 2.6479396044158667, 2.640957474207066, 2.633889459970134, 2.6267362599330184, 2.6194985798171637, 2.6121771327317282, 2.6047726390668307, 2.5972858263858005, 2.589717429316516, 2.582068189441776, 2.5743388551888002, 2.5665301817178174, 2.558642930809811, 2.550677870753416, 2.542635776230981, 2.5345174282038574, 2.5263236137968867, 2.518055126182149, 2.509712764461975, 2.5012973335512365, 2.4928096440589704, 2.4842505121693033, 2.475620759521771, 2.4669212130909886, 2.458152705065734, 2.449316072727449, 2.4404121583281984, 2.431441808968084, 2.4224058764721743, 2.4133052172669225, 2.4041406922561475, 2.3949131666965613, 2.3856235100728966, 2.37627259597263, 2.366861301960351, 2.35739050945177, 2.347861103587426, 2.3382739731060758, 2.3286300102178332, 2.318930110477034, 2.3091751726548906, 2.2993660986119315, 2.2895037931702826, 2.2795891639857544, 2.2696231214198384, 2.259606578411567, 2.249540450349289, 2.239425654942403, 2.2292631120930233, 2.2190537437676507, 2.2087984738688458, 2.198498228106924, 2.188153933871726, 2.177766520104432, 2.167336917169515, 2.1568660567267877, 2.146354871603607, 2.1358042956672536, 2.125215263697491, 2.1145887112593464, 2.1039255745761345, 2.0932267904027233, 2.0824932958991136, 2.07172602850428, 2.060925925810386, 2.0500939254373094, 2.0392309649075635, 2.028337981521603, 2.01741591223354, 2.0064656935273035, 1.9954882612932625, 1.9844845507053062, 1.9734554960984574, 1.962402030846973, 1.9513250872430192, 1.9402255963758825, 1.9291044880117856, 1.9179626904742983, 1.906801130525371, 1.895620733247015, 1.8844224219236565, 1.8732071179251588, 1.8619757405905628, 1.850729207112538, 1.8394684324225905, 1.828194329077017, 1.8169078071436522, 1.8056097740894086, 1.7943011346686257, 1.782982790812273, 1.77165564151799, 1.7603205827410018, 1.748978507285925, 1.737630304699473, 1.7262768611640926, 1.7149190593925325, 1.7035577785233664, 1.6921938940174992, 1.6808282775556416, 1.669461796936811, 1.6580953159778329, 1.6467296944138816, 1.6353657878000853, 1.6240044474141677, 1.6126465201601965, 1.601292848473404, 1.5899442702261193, 1.5786016186348388, 1.5672657221684014, 1.5559374044573349, 1.5446174842043454, 1.5333067750959966, 1.5220060857155562, 1.510716219457053, 1.4994379744405346, 1.4881721434285469, 1.4769195137438509, 1.4656808671883716, 1.4544569799634015, 1.4432486225910823, 1.4320565598371326, 1.420881550634884, 1.4097243480105919, 1.3985856990100514, 1.3874663446265325, 1.3763670197300195, 1.365288452997785, 1.3542313668462977, 1.343196477364463, 1.3321844942482308, 1.3211961207365417, 1.3102320535486434, 1.299292982822771, 1.2883795920562116, 1.27749255804674, 1.266632550835442, 1.2558002336509329, 1.2449962628549613, 1.2342212878894263, 1.2234759512247928, 1.2127608883099, 1.202076727523212, 1.191424090125453, 1.1808035902136735, 1.1702158346767375, 1.1596614231522182, 1.149140947984739, 1.1386549941857187, 1.1282041393945463, 1.1177889538412074, 1.107410000310292, 1.0970678341064803, 1.0867630030214213, 1.0764960473020486, 1.0662674996203385, 1.0560778850444674, 1.045927721011416, 1.0358175173009878, 1.02574777601124, 1.0157189915353597, 1.005731650539924, 0.9957862319446033, 0.9858832069032452, 0.9760230387863963, 0.9662061831652096, 0.9564330877967506, 0.9467041926107085, 0.9370199296974844, 0.9273807232976808, 0.9177869897929647, 0.9082391376982919, 0.8987375676555361, 0.8892826724284317, 0.879874836898922, 0.8705144380648263, 0.8612018450388583, 0.8519374190489889, 0.8427215134401274, 0.8335544736771264, 0.8244366373491055, 0.8153683341750673, 0.8063498860108288, 0.797381606857222, 0.7884638028695768, 0.7795967723684887, 0.7707808058518241, 0.7620161860079897, 0.7533031877304388, 0.7446420781334001, 0.7360331165688441, 0.7274765546446329, 0.7189726362438924, 0.7105215975455452, 0.7021236670460462, 0.6937790655822583, 0.6854880063554908, 0.6772506949566771, 0.6690673293926694, 0.6609381001136645, 0.6528631900417172, 0.6448427746003484, 0.6368770217452299, 0.6289660919959223, 0.6211101384686785, 0.6133093069102716, 0.6055637357328372, 0.5978735560497431, 0.5902388917124326, 0.5826598593482578, 0.5751365683992733, 0.5676691211619753, 0.5602576128279881, 0.5529021315256558, 0.5456027583625408, 0.5383595674688245, 0.5311726260415639, 0.5240419943898169, 0.5169677259806066, 0.5099498674857069, 0.5029884588292539, 0.4960835332361326, 0.4892351172811534, 0.482443230938987, 0.47570788763484034, 0.4690290942958717, 0.4624068514033067, 0.4558411530452566, 0.4493319869702056, 0.4428793346411766, 0.43648317129052416, 0.4301434659753623, 0.4238601816336052, 0.4176332751405892, 0.4114626973662904, 0.4053483932330821, 0.3992903017740364, 0.3932883561917622, 0.3873424839177345, 0.3814526066721165, 0.3756186405240588, 0.3698404959524382, 0.36411807790705036, 0.35845128587020847, 0.3528400139187363, 0.34728415078637065, 0.3417835799264888, 0.3363381795752242, 0.3309478228148836, 0.3256123776376835, 0.3203317070097925, 0.3151056689356325, 0.30993411652245284, 0.3048168980451385, 0.2997538570112403, 0.2947448322262238, 0.2897896578588941, 0.2848881635069979, 0.28004017426297445, 0.2752455107798548, 0.27050398933726655, 0.26581542190755025, 0.2611796162219565, 0.25659637583690603, 0.25206550020031787, 0.24758678471795129, 0.24316002081976856, 0.23878499602631906, 0.23446149401506786, 0.2301892946867304, 0.22596817423153218, 0.22179790519540793, 0.21767825654612677, 0.21360899373930803, 0.20958987878432744, 0.20562067031009237, 0.2017011236306654, 0.19783099081073516, 0.19401002073090312, 0.19023795915277067, 0.1865145487838338, 0.1828395293421386, 0.17921263762070522, 0.17563360755169732, 0.17210217027031516, 0.16861805417842268, 0.1651809850078593, 0.16179068588344986, 0.15844687738568028, 0.15514927761304664, 0.15189760224403684, 0.14869156459875282, 0.14553087570014908, 0.14241524433487587, 0.13934437711372175, 0.136317978531631, 0.13333575102728473, 0.13039739504224948, 0.12750260907965563, 0.12465108976241322, 0.12184253189094776, 0.11907662850043584, 0.1163530709175458, 0.11367154881665296, 0.11103175027554152, 0.10843336183055091, 0.10587606853119322, 0.10335955399419787, 0.10088350045699628, 0.09844758883062141, 0.09605149875202579, 0.09369490863579272, 0.09137749572525355, 0.08909893614297698, 0.08685890494063905, 0.08465707614825745, 0.08249312282278926, 0.08036671709607178, 0.07827753022210977, 0.07622523262369951, 0.07420949393837166, 0.07222998306366854, 0.07028636820172296, 0.06837831690314469, 0.06650549611021855, 0.06466757219938252, 0.06286421102300545, 0.0610950779504413, 0.05935983790836181, 0.0576581554203668, 0.05598969464585741, 0.05435411941817036, 0.05275109328197836, 0.05118027952994024, 0.049641341238601505, 0.04813394130354699, 0.046657742473786984, 0.045212407385404066, 0.04379759859441224, 0.042412978608877626, 0.04105820992025107, 0.03973295503395076, 0.038436876499157405, 0.03716963693785576, 0.035930899073083375, 0.03472032575642459, 0.03353757999471388, 0.03238232497597981, 0.03125422409459687, 0.0301529409756818, 0.029078139498691605, 0.028029483820274193, 0.027006638396321014, 0.02600926800326355, 0.02503703775859413, 0.024089613140614797, 0.023166660007421767, 0.022267844615130396, 0.021392833635321032, 0.02054129417174256, 0.01971289377624923, 0.018907300463982053, 0.01812418272780523, 0.01736320955198858, 0.016624050425154763, 0.015906375352477728, 0.015209854867152874, 0.014534160041133549, 0.013878962495143966, 0.013243934407966904, 0.012628748525025164, 0.012033078166237316, 0.011456597233187392, 0.010898980215582778, 0.010359902197026783, 0.00983903886010018, 0.009336066490770303, 0.008850661982119808, 0.008382502837416286, 0.007931267172523711, 0.007496633717652858, 0.007078281818484264, 0.006675891436644383, 0.006289143149560215, 0.005917718149688751, 0.005561298243144842, 0.005219565847723111, 0.004892203990319428, 0.00457889630378185, 0.004279327023175991, 0.003993180981490049, 0.00372014360478173, 0.003459900906781013, 0.003212139482957557, 0.0029765465040516277, 0.002752809709108358, 0.002540617397986182, 0.002339658423382174, 0.002149622182371791, 0.0019701986074700775, 0.0018010781572352142, 0.0016419518064205332, 0.0014925110356825944, 0.0013524478208631994, 0.0012214546218582989, 0.0010992243710717447, 0.0009854504614823115, 0.0008798267343315295, 0.0007820474664347003, 0.0006918073571399183, 0.0006088015149365819, 0.0005327254437426279, 0.000463275028855598, 0.00040014652260382907, 0.00034303652971245555, 0.00029164199236547276, 0.0002456601750187771, 0.00020478864894548358, 0.00016872527654210323, 0.000137168195401144, 0.00010981580217120154, 8.636673621312304e-05, 6.65198630570752e-05, 4.997425769391901e-05, 3.642918769427815e-05, 2.558409618467904e-05, 1.7138584677691056e-05, 1.0792395791006219e-05, 6.245395842175072e-06, 3.197557359814917e-06, 1.3489415106650303e-06, 3.9968044556661566e-07, 4.995961058076341e-08, -4.40020138549628e-32, ]


a_s_theo = [np.array([a_x_theo[i], 0, a_z_theo[0]]) for i in range(len(a_x_theo))]

theta0_theo = 0.15

g_ref = 9.8
interv = 0.001
g_arr = np.array([0, 0, -1])
x_arr = np.array([1, 0, 0])
theta0_1 = 0.1
theta0_2 = 0.2
theta0_3 = 0.3
radius = 0.6


def step(a_s_raw, a_s, v_s, thetas, g_vect, axis, errors, qqq, v_qqq, pos_qqq, theta_qqq, a_qqq, radius_s, a_s_axis, theta0):
    a_s_axis.append(quat_rotate(qqq, a_s_raw[-1]))
    cos_th = np.cos(thetas[-1]/2)
    sin_th = np.sin(thetas[-1]/2)
    q = quaternion(cos_th, *(axis * sin_th))
    a_s.append((quat_rotate(q, -a_s_raw[-1]) + g_vect))

    cos_th_qqq = np.cos(theta_qqq[-1]/2)
    sin_th_qqq = np.sin(theta_qqq[-1]/2)
    #q_qqq = quaternion(cos_th_qqq, *(axis * sin_th_qqq))
    q_qqq = quaternion(cos_th_qqq, 0, -sin_th_qqq, 0)
    a_qqq.append(-(quat_rotate(q_qqq, a_s_axis[-1]) - g_arr*g_ref))
    v_qqq.append(v_qqq[-1] + interv * a_qqq[-1])
    pos_qqq.append(pos_qqq[-1] + interv * v_qqq[-1])
    theta_qqq_0 = np.arctan2(pos_qqq[-1][2], pos_qqq[-1][0])
    theta_qqq.append(theta_qqq_0 + np.pi/2 - theta0)
    radius_s.append(sqrt(pos_qqq[-1][0]**2 + pos_qqq[-1][2]**2))
    
    v_in_init = v_s[-1] + a_s[-1]*interv
    theta_p = (theta0 + thetas[-1]) / 2
    cos_p = np.cos(theta_p)
    sin_p = np.sin(theta_p)
    q_p = quaternion(cos_p, *(axis * sin_p))
    perp_in_init = np.cross(axis, quat_rotate(q_p, g_vect))
    perp_in_init /= sqrt(np.dot(perp_in_init, perp_in_init))
    perp = np.dot(v_in_init, perp_in_init)
    v_s.append(perp_in_init * perp)
    v_err = v_in_init - v_s[-1]
    errors.append(np.dot(v_err, v_err))
    thetas.append(thetas[-1] + perp * interv / radius)
    
    

def quat_rotate(quat, vect):
    v_q = quaternion(0, *vect)
    res_q = quat * v_q * quat.conjugate()
    return np.array([res_q.x, res_q.y, res_q.z])
    

'''def integr(v0, v1, v_prev):
    return v_prev + (v0 + v1) * interv / 2'''

def quat1(vals):
    cos2theta = np.dot(vals, g_arr) 
    theta = np.arccos(cos2theta) / 2
    axis = np.cross(vals, g_arr)
    axis /= (np.sum(axis**2))**0.5
    return quaternion(np.cos(theta), np.sin(theta) * axis[0], np.sin(theta) * axis[1], np.sin(theta) * axis[2])

def quat2(vals, lat):
    vals = np.array(vals)
    vals /= (np.sum(vals**2))**0.5
    q1 = quat1(vals)
    lat_local = quat_rotate(q1, lat)
    cos2theta = np.dot(lat_local, x_arr)
    theta = np.arccos(cos2theta) / 2
    axis = np.cross(lat_local, x_arr)
    axis /= (np.sum(axis**2))**0.5
    q2 = quaternion(np.cos(theta), np.sin(theta) * axis[0], np.sin(theta) * axis[1], np.sin(theta) * axis[2])
    return q2 * q1

'''vals_ex = np.array([-0.923076923076923, 0.371390676354104, 0.0999897974799508])
lat_ex = np.array([0.230769230769231, 0.742781352708208, -0.628507298445407])
q_ex = quat2(vals_ex, lat_ex)
x_ex = np.array([3/13, 4/13, 12/13])
y_ex = np.array([4/sqrt(29), 3/sqrt(29), -2/sqrt(29)])
z_ex = np.array([-44/13/sqrt(29), 54/13/sqrt(29), -7/13/sqrt(29)])
print("x", x_ex, quat_rotate(q_ex, np.array([1,0,0])))
print("y", y_ex, quat_rotate(q_ex, np.array([0,1,0])))
print("z", z_ex, quat_rotate(q_ex, np.array([0,0,1])))
print("must be [0 0 -1]", quat_rotate(q_ex, vals_ex))
print("must be [1 0 0]", quat_rotate(q_ex, lat_ex))
# print(quat_rotate(q_ex, z_ex))
print("+++++++++")
qq = quat1(vals_ex)
print(quat_rotate(qq, vals_ex))
print(vals_ex, quat_rotate(qq.conjugate(), g_arr))'''
    
    

def calc_g(vals):
    return (sum([val**2 for val in vals]))**0.5
def calc_a1(vals):
    return np.arctan2(vals[1], vals[0])
def calc_a2(vals):
    return np.arctan2(vals[2], (vals[1]**2 + vals[0]**2)**0.5)

ii = 0
iis = []
vect2 = []
fns = [fn for fn in os.listdir('D:\\gestures_zidian') if "data1_" in fn]
def so(fn):
    return int(fn[6:].split(".")[0])
fns.sort(key=so)
vect3 = []
vect4 = []
vect_f = []
vect_g = []
vect_h = []
vect_x = []
vect_y = []
vect_z = []
vectx2 = []
vecty2 = []
vectz2 = []
vectxy = []
vectxz = []
vectyz = []
i = 0
vect = []
for fn in fns:
    #print(fn)
    ii = (ii + 1) % 2 
    with open(fn, "r") as f:
        ff = f.readlines()
        ll_len = len(ff)
        for line in ff:
            i += 1
            vals = [float(v) for v in line.split()]
            assert len(vals) == 3
            vect2.append(calc_g(vals))
            vect3.append(calc_a1(vals))
            vect4.append(calc_a2(vals))
            iis.append(ii+9)
            if 180 <= i <= 220:
                vect.append(calc_g(vals))
                vect_f.append(vals[0])
                vect_g.append(vals[1])
                vect_h.append(vals[2])
            if fn == "data1_1.txt":
                vectx2.append(vals[0]**2)
                vecty2.append(vals[1]**2)
                vectz2.append(vals[2]**2)
                vectxy.append(vals[0]*vals[1])
                vectxz.append(vals[0]*vals[2])
                vectyz.append(vals[1]*vals[2])
                vect_x.append(vals[0])
                vect_y.append(vals[1])
                vect_z.append(vals[2])
                
print(sum(vect)/len(vect))
f = sum(vect_f)/len(vect)
g = sum(vect_g)/len(vect)
h = sum(vect_h)/len(vect)
g_local = np.array([f, g, h])
x2 = sum(vectx2)               
y2 = sum(vecty2)                
z2 = sum(vectz2)                
xy = sum(vectxy)                
xz = sum(vectxz)                
yz = sum(vectyz)

x_mean = sum(vect_x)/len(vect_x)
y_mean = sum(vect_y)/len(vect_y)
z_mean = sum(vect_z)/len(vect_z)
mean = np.array([x_mean, y_mean, z_mean])

b = (f**3*y2/2 - f**3*z2/2 - f**2*g*xy + f**2*h*xz + f*g**2*x2/2 - f*g**2*z2/2 - f*h**2*x2/2 + f*h**2*y2/2 - f*sqrt(f**4*y2**2 - 2*f**4*y2*z2 + 4*f**4*yz**2 + f**4*z2**2 - 4*f**3*g*xy*y2 + 4*f**3*g*xy*z2 - 8*f**3*g*xz*yz - 8*f**3*h*xy*yz + 4*f**3*h*xz*y2 - 4*f**3*h*xz*z2 + 2*f**2*g**2*x2*y2 - 2*f**2*g**2*x2*z2 + 4*f**2*g**2*xy**2 + 4*f**2*g**2*xz**2 - 2*f**2*g**2*y2*z2 + 4*f**2*g**2*yz**2 + 2*f**2*g**2*z2**2 + 8*f**2*g*h*x2*yz - 4*f**2*g*h*y2*yz - 4*f**2*g*h*yz*z2 - 2*f**2*h**2*x2*y2 + 2*f**2*h**2*x2*z2 + 4*f**2*h**2*xy**2 + 4*f**2*h**2*xz**2 + 2*f**2*h**2*y2**2 - 2*f**2*h**2*y2*z2 + 4*f**2*h**2*yz**2 - 4*f*g**3*x2*xy + 4*f*g**3*xy*z2 - 8*f*g**3*xz*yz - 4*f*g**2*h*x2*xz + 8*f*g**2*h*xz*y2 - 4*f*g**2*h*xz*z2 - 4*f*g*h**2*x2*xy - 4*f*g*h**2*xy*y2 + 8*f*g*h**2*xy*z2 - 4*f*h**3*x2*xz - 8*f*h**3*xy*yz + 4*f*h**3*xz*y2 + g**4*x2**2 - 2*g**4*x2*z2 + 4*g**4*xz**2 + g**4*z2**2 + 4*g**3*h*x2*yz - 8*g**3*h*xy*xz - 4*g**3*h*yz*z2 + 2*g**2*h**2*x2**2 - 2*g**2*h**2*x2*y2 - 2*g**2*h**2*x2*z2 + 4*g**2*h**2*xy**2 + 4*g**2*h**2*xz**2 + 2*g**2*h**2*y2*z2 + 4*g**2*h**2*yz**2 + 4*g*h**3*x2*yz - 8*g*h**3*xy*xz - 4*g*h**3*y2*yz + h**4*x2**2 - 2*h**4*x2*y2 + 4*h**4*xy**2 + h**4*y2**2)/2 + g**2*h*xz - g*h**2*xy)/(f**3*yz - f**2*g*xz - f**2*h*xy + f*g**2*yz + f*g*h*x2 - f*g*h*y2 - g**3*xz + g**2*h*xy)
c = 1
a = -(b*g + h)/f

k1 = (b*h - g*c)/(g*a - b*f)
k2 = (c*f - h*a)/(g*a - b*f)
z_1 = 1 / sqrt(k1**2 + k2**2 + 1)
lat_1 = np.array([k1*z_1, k2*z_1, z_1])
lat_2 = -lat_1
lat = lat_1 if np.dot(lat_1, mean) > 0 else lat_2

# mean1 = mean - g_local * (np.dot(g_local, mean)/np.dot(g_local, g_local))
# print("dot", np.dot(lat_1/sqrt(np.dot(lat_1, lat_1)), mean1/sqrt(np.dot(mean1, mean1))))
# print("cross", np.cross(lat_1/sqrt(np.dot(lat_1, lat_1)), mean1/sqrt(np.dot(mean1, mean1))))
# lat = -mean1 / sqrt(np.dot(mean1, mean1))

qqq = quat2(g_local, lat)

axis = np.cross(g_local, lat)
axis /= sqrt(np.dot(axis, axis))
# print("qqq axis", quat_rotate(qqq, axis))

i = 0

a_s_raw = []
a_s = []
v_s = [np.array([0,0,0])]
thetas = [0]
errors = []
i_s = []
a_s_axis = []

v_qqq_1 = [np.array([0,0,0])]
pos_qqq_1 = [radius*np.array([np.sin(theta0_1), 0, -np.cos(theta0_1)])]
theta_qqq_1 = [0]
a_qqq_1 = [np.array([0,0,0])]
radius_s_1 = [radius]
v_qqq_2 = [np.array([0,0,0])]
pos_qqq_2 = [radius*np.array([np.sin(theta0_2), 0, -np.cos(theta0_2)])]
theta_qqq_2 = [0]
a_qqq_2 = [np.array([0,0,0])]
radius_s_2 = [radius]
v_qqq_3 = [np.array([0,0,0])]
pos_qqq_3 = [radius*np.array([np.sin(theta0_3), 0, -np.cos(theta0_3)])]
theta_qqq_3 = [0]
a_qqq_3 = [np.array([0,0,0])]
radius_s_3 = [radius]

'''for fn in fns: 
    with open(fn, "r") as f:
        ff = f.readlines()
        ll_len = len(ff)
        for line in ff:
            i += 1
            vals = [float(v) for v in line.split()]
            assert len(vals) == 3
            if fn == "data1_1.txt":
                i_s.append(i)
                a_s_raw.append(np.array(vals))
                step(a_s_raw, a_s, v_s, thetas, g_local, axis, errors, qqq, v_qqq_1, pos_qqq_1, theta_qqq_1, a_qqq_1, radius_s_1, a_s_axis, theta0_1)
                step(a_s_raw, a_s, v_s, thetas, g_local, axis, errors, qqq, v_qqq_2, pos_qqq_2, theta_qqq_2, a_qqq_2, radius_s_2, a_s_axis, theta0_2)
                step(a_s_raw, a_s, v_s, thetas, g_local, axis, errors, qqq, v_qqq_3, pos_qqq_3, theta_qqq_3, a_qqq_3, radius_s_3, a_s_axis, theta0_3)
i_s.append(i_s[-1] + 1)'''

def step_theo(a_theo, v_qqq, pos_qqq, theta_qqq, a_qqq, radius_s, a_s_axis, theta0):
    a_s_axis.append(a_theo)

    cos_th_qqq = np.cos(theta_qqq[-1]/2)
    sin_th_qqq = np.sin(theta_qqq[-1]/2)
    q_qqq = quaternion(cos_th_qqq, 0, -sin_th_qqq, 0)
    a_qqq.append(quat_rotate(q_qqq, -a_s_axis[-1]) + g_arr*g_ref)
    v_qqq.append(v_qqq[-1] + interv * a_qqq[-1])
    pos_qqq.append(pos_qqq[-1] + interv * v_qqq[-1])
    theta_qqq_0 = np.arctan2(pos_qqq[-1][2], pos_qqq[-1][0])
    theta_qqq.append(theta_qqq_0 + np.pi/2 - theta0)
    radius_s.append(sqrt(pos_qqq[-1][0]**2 + pos_qqq[-1][2]**2))

i = 1
i_s_theo = [0]
v_theo = [np.array([0,0,0])]
pos_theo = [radius*np.array([np.sin(theta0_theo), 0, -np.cos(theta0_theo)])]
theta_theo = [0]
a_abs_theo = [np.array([0,0,0])]
radius_s_theo = [radius]
a_s_axis_theo = []
for a in a_s_theo:
    step_theo(a_s_theo[i_s_theo[-1]], v_theo, pos_theo, theta_theo, a_abs_theo, radius_s_theo, a_s_axis_theo, theta0_theo)
    i_s_theo.append(i)
    i += 1


#errors.append(errors[-1])


# q_base = quat2(g_local, lat)
                
                

x = np.arange(len(vect2))
y = np.array(vect2)
y3 = np.array(vect3)
y4 = np.array(vect4)
y2 = np.array(iis)
fig, ax = plt.subplots()
#ax.plot(x, y)
#ax.plot(x, y2)
#ax.plot(x, y3)
#ax.plot(x, y4)
i_s = np.array(i_s)
a_s_axis = np.array(a_s_axis)
'''thetas = np.array(thetas)
ax.plot(i_s, thetas)'''
'''a_qqq = np.array(a_qqq)
ax.plot(i_s, a_qqq[:,0])
ax.plot(i_s, a_qqq[:,1])
ax.plot(i_s, a_qqq[:,2])
ax.plot(i_s, theta_qqq)'''
'''ax.plot(i_s, errors)
ax.plot(i_s, radius_s)'''
'''ax.plot(i_s, a_s_axis[:,0])
ax.plot(i_s, a_s_axis[:,1])
ax.plot(i_s, a_s_axis[:,2])'''
'''ax.plot(i_s, theta_qqq_1)
ax.plot(i_s, theta_qqq_2)
ax.plot(i_s, theta_qqq_3)'''
ax.plot(i_s_theo, theta_theo)
ax.plot(list(range(len(theta_t))), theta_t)
ax.legend(["theta", "theor_theta"])
plt.show()
